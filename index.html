<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Banditi - Team Stats</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    background-color: #1f1f2e;
    color: #f0f0f0;
    font-family: 'Segoe UI', sans-serif;
    padding: 20px;
  }
  .header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin-bottom: 20px;
  }
  .header img {
    height: 60px;
    user-select: none;
  }
  .header h1 {
    color: #00ffc8;
    margin: 0;
    font-size: 2.2em;
  }
  .nav {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 25px;
  }
  .nav button {
    background-color: #00ffc8;
    color: #1f1f2e;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  .nav button:hover {
    background-color: #00d1a8;
  }
  .section {
    display: none;
  }
  .section.active {
    display: block;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background-color: #2a2a3d;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
    margin-bottom: 30px;
  }
  th, td {
    padding: 12px 18px;
    text-align: center;
    border-bottom: 1px solid #3c3c50;
  }
  th {
    background-color: #34344a;
    color: #00ffc8;
    font-weight: bold;
  }
  tr:nth-child(even) {
    background-color: #262636;
  }
  tr:hover {
    background-color: #3a3a56;
  }
  td[contenteditable="true"] {
    cursor: text;
    background-color: #3a3a56;
  }
  .tables-container {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }
  .table-wrapper {
    flex: 1;
    min-width: 300px;
  }
  .chart-wrapper {
    flex: 1;
    min-width: 300px;
  }
  .update-info {
    font-size: 0.8em;
    color: #00ffc8;
    text-align: right;
    margin-bottom: 10px;
  }
  .limits {
    background-color: #2a2a3d;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
  }
  .limits h2 {
    color: #00ffc8;
    margin-top: 0;
  }
  .limits ul {
    columns: 2;
    padding-left: 20px;
  }
  .limits li {
    margin-bottom: 5px;
  }
  #guildInfo {
    width: 100%;
    min-height: 500px;
    background-color: #2a2a3d;
    color: #f0f0f0;
    border: 1px solid #3c3c50;
    border-radius: 10px;
    padding: 15px;
    font-family: 'Segoe UI', sans-serif;
    resize: vertical;
  }
  .edit-icon {
    cursor: pointer;
    color: #00ffc8;
    margin-left: 10px;
    font-size: 0.8em;
  }
  .add-player {
    background-color: #00ffc8;
    color: #1f1f2e;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    margin-bottom: 20px;
  }
  .add-player:hover {
    background-color: #00d1a8;
  }
  .update-btn {
    background-color: #00ffc8;
    color: #1f1f2e;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    margin-bottom: 10px;
  }
  .update-btn:hover {
    background-color: #00d1a8;
  }
  .positive {
    color: #00ff00;
  }
  .negative {
    color: #ff0000;
  }
  .workshop-status {
    font-weight: bold;
  }
  canvas {
    width: 100% !important;
    height: 400px !important;
  }
</style>
</head>
<body>

<div class="header">
  <img src="logo.png" alt="Logo">
  <h1>Banditi - Team Stats</h1>
</div>

<div class="nav">
  <button onclick="showSection('guild')">üè∞ Guild Info</button>
  <button onclick="showSection('players')">üë• Players Info</button>
  <button onclick="showSection('xp')">üìà XP Tournament</button>
  <button onclick="showSection('herocon')">‚öîÔ∏è HeroCon Tournament</button>
</div>

<div id="guild" class="section">
  <h2>Guild Info <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  <textarea id="guildInfo" readonly>
Casino: 

Casino with high quality rewards
2025-07-02 00:00:00 - 2025-07-05 23:59:59

"Chic Hero Hideout" Casino
2025-07-08 00:00:00 - 2025-07-13 23:59:59

Casino with high quality rewards
2025-07-18 00:00:00 - 2025-07-21 23:59:59

Casino without Coins or Experience Points, but with higher chance of all other prizes
2025-07-25 00:00:00 - 2025-07-28 23:59:59


Bonus Days:

Double Coins from Missions
2025-07-02 00:00:00 - 2025-07-05 23:59:59

Double Energy for Missions
2025-07-18 00:00:00 - 2025-07-21 23:59:59

Double Motivation Units
2025-07-26 00:00:00 - 2025-07-28 23:59:59


Events:

Summer Begins
2025-06-21 00:00:00 - 2025-09-21 23:59:59

Supervillain Lair: Dr. Wireless
2025-06-30 00:00:00 - 2025-07-05 23:59:59

Collection Event: The Secret Recipe
2025-07-01 00:00:00 - 2025-07-07 23:59:59

Lucky Pyramid: Country Livin'
2025-07-05 00:00:00 - 2025-07-07 23:59:59

Collection Event: The fiiinaaal! Wooohooooo!
2025-07-10 00:00:00 - 2025-07-13 23:59:59

Mole Hunt: Fire
2025-07-12 00:00:00 - 2025-07-14 23:59:59

Collection Event: The Solar Soapbox Derby
2025-07-14 00:00:00 - 2025-07-21 23:59:59

Mole Hunt: Retro Delights
2025-07-19 00:00:00 - 2025-07-22 23:59:59

Lucky Pyramid: Aliens
2025-07-22 00:00:00 - 2025-07-24 23:59:59

System Administrator Day
2025-07-25 00:00:00 - 2025-07-25 23:59:59

System Administrator Bonus Days
2025-07-26 00:00:00 - 2025-07-28 23:59:59

Collection Event: The International Hero Championships
2025-07-30 00:00:00 - 2025-08-06 23:59:59


HeroCons:

2025-07-03 21:00:00 Modifications produced at your Hero Hideout
2025-07-10 21:00:00 Attacks on villains
2025-07-17 21:00:00 Missions completed
2025-07-24 21:00:00 Special Missions Won


Villains:

2025-07-01 15:30:00 Nasty Burglar Duo
2025-07-02 06:00:00 The Joker
2025-07-02 19:45:00 Nasty Burglar Duo
2025-07-03 20:00:00 The Joker
2025-07-04 16:30:00 Boorish Rocker Rowdy
2025-07-05 07:45:00 Nasty Burglar Duo
2025-07-05 19:00:00 C3-D2
2025-07-06 02:15:00 The Joker
2025-07-06 16:15:00 Boorish Rocker Rowdy
2025-07-07 02:15:00 General Bombman
2025-07-08 00:30:00 The Joker
2025-07-08 20:00:00 Pompous Salesman
2025-07-09 04:00:00 C3-D2
2025-07-09 18:15:00 Nasty Burglar Duo
2025-07-10 05:30:00 The Joker
2025-07-10 15:15:00 The Avenging Avenger
2025-07-11 10:00:00 General Bombman
2025-07-11 15:30:00 Boorish Rocker Rowdy
2025-07-12 14:00:00 Ice Cold Real Estate Shark
2025-07-12 20:00:00 Nasty Burglar Duo
2025-07-13 06:30:00 C3-D2
2025-07-13 20:00:00 The Avenging Avenger
2025-07-14 07:00:00 Pompous Salesman
2025-07-14 20:00:00 The Quantum Physicist
2025-07-15 07:45:00 Ice Cold Real Estate Shark
2025-07-15 16:45:00 Pompous Salesman
2025-07-16 05:15:00 Nasty Burglar Duo
2025-07-17 04:45:00 Boorish Rocker Rowdy
2025-07-17 16:30:00 General Bombman
2025-07-18 08:00:00 The Avenging Avenger
2025-07-19 11:30:00 The Joker
2025-07-20 00:30:00 Pompous Salesman
2025-07-20 09:45:00 The Quantum Physicist
2025-07-21 07:00:00 Nasty Burglar Duo
2025-07-22 10:45:00 Ice Cold Real Estate Shark
2025-07-23 05:15:00 General Bombman
2025-07-24 04:00:00 The Joker
2025-07-25 03:30:00 The Avenging Avenger
2025-07-25 17:45:00 The Quantum Physicist
2025-07-26 06:00:00 Nasty Burglar Duo
2025-07-26 20:00:00 Pompous Salesman
2025-07-27 05:00:00 The Joker
2025-07-27 15:30:00 Ice Cold Real Estate Shark
2025-07-28 17:45:00 The Joker
2025-07-29 04:15:00 The Quantum Physicist
2025-07-29 20:00:00 Boorish Rocker Rowdy
2025-07-30 09:30:00 Pompous Salesman
2025-07-30 16:15:00 The Avenging Avenger
2025-07-31 03:15:00 Nasty Burglar Duo
2025-07-31 10:45:00 The Quantum Physicist
2025-07-31 15:30:00 Ice Cold Real Estate Shark
  </textarea>
</div>

<div id="players" class="section">
  <h2>Players Info <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  
  <div class="limits">
    <h2>Limity d√≠lny podle levelu:</h2>
    <ul>
        <li>Lvl 500+ ‚Üí D√≠lna 20</li>
        <li>Lvl 450+ ‚Üí D√≠lna 19</li>
        <li>Lvl 400+ ‚Üí D√≠lna 18</li>
        <li>Lvl 350+ ‚Üí D√≠lna 17</li>
        <li>Lvl 325+ ‚Üí D√≠lna 16</li>
        <li>Lvl 300+ ‚Üí D√≠lna 15</li>
        <li>Lvl 275+ ‚Üí D√≠lna 14</li>
        <li>Lvl 250+ ‚Üí D√≠lna 13</li>
        <li>Lvl 230+ ‚Üí D√≠lna 12</li>
        <li>Lvl 210+ ‚Üí D√≠lna 11</li>
        <li>Lvl 190+ ‚Üí D√≠lna 10</li>
        <li>Lvl 170+ ‚Üí D√≠lna 9</li>
        <li>Lvl 150+ ‚Üí D√≠lna 8</li>
        <li>Lvl 100+ ‚Üí D√≠lna 7</li>
    </ul>
  </div>
  
  <button class="add-player" onclick="addPlayerRow('playersBody')">‚ûï Add Player</button>
  
  <table>
    <thead>
      <tr>
        <th>Nickname</th>
        <th>Level</th>
        <th>Workshop Level</th>
        <th>Workshop Status</th>
        <th>Vynechan√© boje</th>
      </tr>
    </thead>
    <tbody id="playersBody">
    </tbody>
  </table>
</div>

<div id="xp" class="section">
  <h2>XP Tournament <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  
  <button class="update-btn" onclick="updateTournament('xp')">üîÑ Aktualizovat</button>
  <button class="add-player" onclick="addPlayerRow('xpBody')">‚ûï Add Player</button>
  
  <div class="tables-container">
    <div class="table-wrapper">
      <div class="update-info">Last updated: <span id="xpUpdateDate"></span></div>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>XP Gained</th>
          </tr>
        </thead>
        <tbody id="xpBody">
          <tr><td>1</td><td contenteditable="false">Alfa</td><td contenteditable="false">1230</td></tr>
          <tr><td>2</td><td contenteditable="false">Sazaro</td><td contenteditable="false">980</td></tr>
          <tr><td>3</td><td contenteditable="false">Bandita</td><td contenteditable="false">840</td></tr>
        </tbody>
      </table>
    </div>
    <div class="chart-wrapper">
      <canvas id="xpChart"></canvas>
    </div>
  </div>
</div>

<div id="herocon" class="section">
  <h2>HeroCon Tournament <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  
  <button class="update-btn" onclick="updateTournament('herocon')">üîÑ Aktualizovat</button>
  <button class="add-player" onclick="addPlayerRow('heroconBody')">‚ûï Add Player</button>
  
  <div class="tables-container">
    <div class="table-wrapper">
      <div class="update-info">Last updated: <span id="heroconUpdateDate"></span></div>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>HeroCon Gained</th>
          </tr>
        </thead>
        <tbody id="heroconBody">
          <tr><td>1</td><td contenteditable="false">Alfa</td><td contenteditable="false">540</td></tr>
          <tr><td>2</td><td contenteditable="false">Sazaro</td><td contenteditable="false">480</td></tr>
          <tr><td>3</td><td contenteditable="false">Bandita</td><td contenteditable="false">410</td></tr>
        </tbody>
      </table>
    </div>
    <div class="chart-wrapper">
      <canvas id="heroconChart"></canvas>
    </div>
  </div>
</div>

<script>
const password = "TopBanditi1";
let unlocked = localStorage.getItem("unlocked") === "true";
const limits = [
    {level: 500, workshop: 20},
    {level: 450, workshop: 19},
    {level: 400, workshop: 18},
    {level: 350, workshop: 17},
    {level: 325, workshop: 16},
    {level: 300, workshop: 15},
    {level: 275, workshop: 14},
    {level: 250, workshop: 13},
    {level: 230, workshop: 12},
    {level: 210, workshop: 11},
    {level: 190, workshop: 10},
    {level: 170, workshop: 9},
    {level: 150, workshop: 8},
    {level: 100, workshop: 7}
];

function requestEditAccess() {
    if (unlocked) {
        enableEditing();
        return;
    }
    
    const input = prompt("Zadej heslo pro √∫pravu:");
    if (input === password) {
        localStorage.setItem("unlocked", "true");
        unlocked = true;
        alert("‚úÖ P≈ô√≠stup povolen.");
        enableEditing();
    } else {
        alert("‚ùå ≈†patn√© heslo.");
    }
}

function enableEditing() {
    // Enable guild info editing
    document.getElementById('guildInfo').readOnly = false;
    
    // Enable table editing (except rank columns)
    document.querySelectorAll('td[contenteditable="false"]').forEach(el => {
        if (!el.textContent.match(/^\d+$/) || el.textContent === "") { // Don't make rank numbers editable
            el.setAttribute('contenteditable', 'true');
        }
    });
    
    // Show all edit icons
    document.querySelectorAll('.edit-icon').forEach(icon => {
        icon.style.display = 'inline';
    });
}

function showSection(id) {
    document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

window.onload = () => {
    showSection('players');
    initializePlayersTable();
    updateCharts();
    setUpdateDates();
    
    if (!unlocked) {
        document.getElementById('guildInfo').readOnly = true;
        document.querySelectorAll('[contenteditable="false"]').forEach(el => {
            el.setAttribute('contenteditable', 'false');
        });
    }
};

function setUpdateDates() {
    const now = new Date();
    const dateStr = now.toLocaleString('cs-CZ');
    document.getElementById('xpUpdateDate').textContent = dateStr;
    document.getElementById('heroconUpdateDate').textContent = dateStr;
}

function initializePlayersTable() {
    const players = [
        {name: "Sazaro", level: 372, workshop: 17, missed: 0},
        {name: "Alfa", level: 482, workshop: 21, missed: 0},
        {name: "Liones", level: 359, workshop: 17, missed: 0},
        {name: "Bandita", level: 339, workshop: 16, missed: 0},
        {name: "Blesk", level: 331, workshop: 19, missed: 0},
        {name: "Ranny", level: 311, workshop: 17, missed: 0},
        {name: "Loniz1337", level: 301, workshop: 18, missed: 0}
    ];

    const tbody = document.getElementById('playersBody');
    players.forEach((p, index) => {
        addPlayerRow('playersBody', p.name, p.level, p.workshop, p.missed);
    });
}

function getRoleIcon(nickname) {
    if (nickname === 'Sazaro') return '‚≠ê ';
    if (['Alfa', 'Liones', 'Bandita', 'Blesk', 'Ranny', 'Loniz1337'].includes(nickname)) return 'üî∞ ';
    return '';
}

function getMaxWorkshop(level) {
    if (!level) return 0;
    level = parseInt(level);
    for (const limit of limits) {
        if (level >= limit.level) {
            return limit.workshop;
        }
    }
    return 7;
}

function getWorkshopStatus(level, workshop) {
    if (!level || !workshop) return "";
    const max = getMaxWorkshop(level);
    const diff = parseInt(workshop) - max;
    
    if (diff === 0) {
        return '<span class="workshop-status">OK</span>';
    } else if (diff > 0) {
        return `<span class="workshop-status positive">+${diff}</span>`;
    } else {
        return `<span class="workshop-status negative">${diff}</span>`;
    }
}

function addPlayerRow(tableId, name = "", level = "", workshop = "", missed = "") {
    const tbody = document.getElementById(tableId);
    const row = document.createElement('tr');
    
    if (tableId === 'playersBody') {
        row.innerHTML = `
            <td contenteditable="${unlocked}">${getRoleIcon(name) + name}</td>
            <td contenteditable="${unlocked}">${level}</td>
            <td contenteditable="${unlocked}">${workshop}</td>
            <td>${getWorkshopStatus(level, workshop)}</td>
            <td contenteditable="${unlocked}">${missed}</td>
        `;
        
        // Add event listeners to update workshop status when level or workshop changes
        const levelCell = row.cells[1];
        const workshopCell = row.cells[2];
        const statusCell = row.cells[3];
        
        const updateStatus = () => {
            statusCell.innerHTML = getWorkshopStatus(levelCell.textContent, workshopCell.textContent);
        };
        
        levelCell.addEventListener('blur', updateStatus);
        workshopCell.addEventListener('blur', updateStatus);
    } else {
        const rowCount = tbody.querySelectorAll('tr').length + 1;
        row.innerHTML = `
            <td>${rowCount}</td>
            <td contenteditable="${unlocked}">${name}</td>
            <td contenteditable="${unlocked}">${level}</td>
        `;
    }
    
    tbody.appendChild(row);
}

function updateTournament(type) {
    const now = new Date();
    const dateStr = now.toLocaleString('cs-CZ');
    
    // Update the "last updated" date
    document.getElementById(`${type}UpdateDate`).textContent = dateStr;
    
    // Get current data from the table
    const tbody = document.getElementById(`${type}Body`);
    const rows = tbody.querySelectorAll('tr');
    const data = [];
    
    rows.forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length >= 3) {
            data.push({
                rank: cells[0].textContent,
                name: cells[1].textContent,
                value: cells[2].textContent
            });
        }
    });
    
    // Sort data by value (descending)
    data.sort((a, b) => parseInt(b.value) - parseInt(a.value));
    
    // Update ranks in the table
    data.forEach((item, index) => {
        const row = rows[index];
        if (row) {
            const cells = row.querySelectorAll('td');
            cells[0].textContent = index + 1;
            cells[1].textContent = item.name;
            cells[2].textContent = item.value;
        }
    });
    
    // Update chart
    updateCharts();
}

function updateCharts() {
    // Get data from tables
    const xpData = [];
    const xpLabels = [];
    document.querySelectorAll('#xpBody tr').forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length >= 3 && cells[1].textContent && cells[2].textContent) {
            xpLabels.push(cells[1].textContent);
            xpData.push(parseInt(cells[2].textContent) || 0);
        }
    });

    const heroconData = [];
    const heroconLabels = [];
    document.querySelectorAll('#heroconBody tr').forEach(row => {
        const cells = row.querySelectorAll('td');
        if (cells.length >= 3 && cells[1].textContent && cells[2].textContent) {
            heroconLabels.push(cells[1].textContent);
            heroconData.push(parseInt(cells[2].textContent) || 0);
        }
    });

    // XP Chart
    const xpCanvas = document.getElementById('xpChart');
    const xpCtx = xpCanvas.getContext('2d');
    
    // Destroy previous chart if it exists
    if (window.xpChart) {
        window.xpChart.destroy();
    }
    
    window.xpChart = new Chart(xpCtx, {
        type: 'bar',
        data: {
            labels: xpLabels,
            datasets: [{
                label: 'XP Gained',
                data: xpData,
                backgroundColor: '#00ffc8'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'XP Gained'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Players'
                    }
                }
            }
        }
    });

    // HeroCon Chart
    const heroconCanvas = document.getElementById('heroconChart');
    const heroconCtx = heroconCanvas.getContext('2d');
    
    // Destroy previous chart if it exists
    if (window.heroconChart) {
        window.heroconChart.destroy();
    }
    
    window.heroconChart = new Chart(heroconCtx, {
        type: 'bar',
        data: {
            labels: heroconLabels,
            datasets: [{
                label: 'HeroCon Gained',
                data: heroconData,
                backgroundColor: '#00ffc8'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: {
                        display: true,
                        text: 'HeroCon Gained'
                    }
                },
                x: {
                    title: {
                        display: true,
                        text: 'Players'
                    }
                }
            }
        }
    });
}
</script>

</body>
</html>
