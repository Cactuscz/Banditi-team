<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8" />
<title>Banditi - Team Stats</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  body {
    background-color: #1f1f2e;
    color: #f0f0f0;
    font-family: 'Segoe UI', sans-serif;
    padding: 20px;
  }
  .header {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin-bottom: 20px;
  }
  .header img {
    height: 60px;
    user-select: none;
  }
  .header h1 {
    color: #00ffc8;
    margin: 0;
    font-size: 2.2em;
  }
  .nav {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 25px;
  }
  .nav button {
    background-color: #00ffc8;
    color: #1f1f2e;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }
  .nav button:hover {
    background-color: #00d1a8;
  }
  .section {
    display: none;
  }
  .section.active {
    display: block;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    background-color: #2a2a3d;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 0 15px rgba(0,0,0,0.5);
    margin-bottom: 10px;
  }
  th, td {
    padding: 12px 18px;
    text-align: center;
    border-bottom: 1px solid #3c3c50;
  }
  th {
    background-color: #34344a;
    color: #00ffc8;
    font-weight: bold;
  }
  tr:nth-child(even) {
    background-color: #262636;
  }
  tr:hover {
    background-color: #3a3a56;
  }
  td[contenteditable="true"] {
    cursor: text;
    background-color: #3a3a56;
  }
  .tables-container {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }
  .table-wrapper {
    flex: 1;
    min-width: 300px;
  }
  .chart-wrapper {
    flex: 1;
    min-width: 300px;
  }
  .update-info {
    font-size: 0.8em;
    color: #00ffc8;
    text-align: right;
    margin-bottom: 10px;
  }
  .limits {
    background-color: #2a2a3d;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
  }
  .limits h2 {
    color: #00ffc8;
    margin-top: 0;
  }
  .limits ul {
    columns: 2;
    padding-left: 20px;
  }
  .limits li {
    margin-bottom: 5px;
  }
  #guildInfo {
    width: 100%;
    min-height: 500px;
    background-color: #2a2a3d;
    color: #f0f0f0;
    border: 1px solid #3c3c50;
    border-radius: 10px;
    padding: 15px;
    font-family: 'Segoe UI', sans-serif;
    resize: vertical;
  }
  .edit-icon {
    cursor: pointer;
    color: #00ffc8;
    margin-left: 10px;
    font-size: 0.8em;
  }
  .add-player {
    background-color: #00ffc8;
    color: #1f1f2e;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    margin-bottom: 20px;
  }
  .add-player:hover {
    background-color: #00d1a8;
  }
  .update-btn {
    background-color: #00ffc8;
    color: #1f1f2e;
    border: none;
    padding: 8px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    margin-bottom: 10px;
  }
  .update-btn:hover {
    background-color: #00d1a8;
  }
  .positive {
    color: #00ff00;
  }
  .negative {
    color: #ff0000;
  }
  .workshop-status {
    font-weight: bold;
  }
  canvas {
    width: 100% !important;
    height: 400px !important;
  }
  .history {
    background-color: #262636;
    border-radius: 10px;
    padding: 10px;
    margin-top: 10px;
    max-height: 150px;
    overflow-y: auto;
    font-size: 0.9em;
  }
  .history h3 {
    margin-top: 0;
    color: #00ffc8;
  }
  .history-entry {
    border-bottom: 1px solid #3c3c50;
    padding: 6px 0;
  }
  .history-entry:last-child {
    border-bottom: none;
  }
</style>
</head>
<body>

<div class="header">
  <img src="logo.png" alt="Logo" />
  <h1>Banditi - Team Stats</h1>
</div>

<div class="nav">
  <button onclick="showSection('guild')">üè∞ Guild Info</button>
  <button onclick="showSection('players')">üë• Players Info</button>
  <button onclick="showSection('xp')">üìà XP Tournament</button>
  <button onclick="showSection('herocon')">‚öîÔ∏è HeroCon Tournament</button>
</div>

<div id="guild" class="section">
  <h2>Guild Info <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  <textarea id="guildInfo" readonly>
Casino: 

Casino with high quality rewards
2025-07-02 00:00:00 - 2025-07-05 23:59:59

"Chic Hero Hideout" Casino
2025-07-08 00:00:00 - 2025-07-13 23:59:59

Casino with high quality rewards
2025-07-18 00:00:00 - 2025-07-21 23:59:59

Casino without Coins or Experience Points, but with higher chance of all other prizes
2025-07-25 00:00:00 - 2025-07-28 23:59:59


Bonus Days:

Double Coins from Missions
2025-07-02 00:00:00 - 2025-07-05 23:59:59

Double Energy for Missions
2025-07-18 00:00:00 - 2025-07-21 23:59:59

Double Motivation Units
2025-07-26 00:00:00 - 2025-07-28 23:59:59


Events:

Summer Begins
2025-06-21 00:00:00 - 2025-09-21 23:59:59

Supervillain Lair: Dr. Wireless
2025-06-30 00:00:00 - 2025-07-05 23:59:59

Collection Event: The Secret Recipe
2025-07-01 00:00:00 - 2025-07-07 23:59:59

Lucky Pyramid: Country Livin'
2025-07-05 00:00:00 - 2025-07-07 23:59:59

Collection Event: The fiiinaaal! Wooohooooo!
2025-07-10 00:00:00 - 2025-07-13 23:59:59

Mole Hunt: Fire
2025-07-12 00:00:00 - 2025-07-14 23:59:59

Collection Event: The Solar Soapbox Derby
2025-07-14 00:00:00 - 2025-07-21 23:59:59

Mole Hunt: Retro Delights
2025-07-19 00:00:00 - 2025-07-22 23:59:59

Lucky Pyramid: Aliens
2025-07-22 00:00:00 - 2025-07-24 23:59:59

System Administrator Day
2025-07-25 00:00:00 - 2025-07-25 23:59:59

System Administrator Bonus Days
2025-07-26 00:00:00 - 2025-07-28 23:59:59

Collection Event: The International Hero Championships
2025-07-30 00:00:00 - 2025-08-06 23:59:59


HeroCons:

2025-07-03 21:00:00 Modifications produced at your Hero Hideout
2025-07-10 21:00:00 Attacks on villains
2025-07-17 21:00:00 Missions completed
2025-07-24 21:00:00 Special Missions Won


Villains:

2025-07-01 15:30:00 Nasty Burglar Duo
2025-07-02 06:00:00 The Joker
2025-07-02 19:45:00 Nasty Burglar Duo
2025-07-03 20:00:00 The Joker
2025-07-04 16:30:00 Boorish Rocker Rowdy
2025-07-05 07:45:00 Nasty Burglar Duo
2025-07-05 19:00:00 C3-D2
2025-07-06 02:15:00 The Joker
2025-07-06 16:15:00 Boorish Rocker Rowdy
2025-07-07 02:15:00 General Bombman
2025-07-08 00:30:00 The Joker
2025-07-08 20:00:00 Pompous Salesman
2025-07-09 04:00:00 C3-D2
2025-07-09 18:15:00 Nasty Burglar Duo
2025-07-10 05:30:00 The Joker
2025-07-10 15:15:00 The Avenging Avenger
2025-07-11 10:00:00 General Bombman
2025-07-11 15:30:00 Boorish Rocker Rowdy
2025-07-12 14:00:00 Ice Cold Real Estate Shark
2025-07-12 20:00:00 Nasty Burglar Duo
2025-07-13 06:30:00 C3-D2
2025-07-13 20:00:00 The Avenging Avenger
2025-07-14 07:00:00 Pompous Salesman
2025-07-14 20:00:00 The Quantum Physicist
2025-07-15 07:45:00 Ice Cold Real Estate Shark
2025-07-15 16:45:00 Pompous Salesman
2025-07-16 05:15:00 Nasty Burglar Duo
2025-07-17 04:45:00 Boorish Rocker Rowdy
2025-07-17 16:30:00 General Bombman
2025-07-18 08:00:00 The Avenging Avenger
2025-07-19 11:30:00 The Joker
2025-07-20 00:30:00 Pompous Salesman
2025-07-20 09:45:00 The Quantum Physicist
2025-07-21 07:00:00 Nasty Burglar Duo
2025-07-22 10:45:00 Ice Cold Real Estate Shark
2025-07-23 05:15:00 General Bombman
2025-07-24 04:00:00 The Joker
2025-07-25 03:30:00 The Avenging Avenger
2025-07-25 17:45:00 The Quantum Physicist
2025-07-26 06:00:00 Nasty Burglar Duo
2025-07-26 20:00:00 Pompous Salesman
2025-07-27 05:00:00 The Joker
2025-07-27 15:30:00 Ice Cold Real Estate Shark
2025-07-28 17:45:00 The Joker
2025-07-29 04:15:00 The Quantum Physicist
2025-07-29 20:00:00 Boorish Rocker Rowdy
2025-07-30 09:30:00 Pompous Salesman
2025-07-30 16:15:00 The Avenging Avenger
2025-07-31 03:15:00 Nasty Burglar Duo
2025-07-31 10:45:00 The Quantum Physicist
2025-07-31 15:30:00 Ice Cold Real Estate Shark
  </textarea>
</div>

<div id="players" class="section">
  <h2>Players Info <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  
  <div class="limits">
    <h2>Limity d√≠lny podle levelu:</h2>
    <ul>
        <li>Lvl 500+ ‚Üí D√≠lna 20</li>
        <li>Lvl 450+ ‚Üí D√≠lna 19</li>
        <li>Lvl 400+ ‚Üí D√≠lna 18</li>
        <li>Lvl 350+ ‚Üí D√≠lna 17</li>
        <li>Lvl 325+ ‚Üí D√≠lna 16</li>
        <li>Lvl 300+ ‚Üí D√≠lna 15</li>
        <li>Lvl 275+ ‚Üí D√≠lna 14</li>
        <li>Lvl 250+ ‚Üí D√≠lna 13</li>
        <li>Lvl 230+ ‚Üí D√≠lna 12</li>
        <li>Lvl 210+ ‚Üí D√≠lna 11</li>
        <li>Lvl 190+ ‚Üí D√≠lna 10</li>
        <li>Lvl 170+ ‚Üí D√≠lna 9</li>
        <li>Lvl 150+ ‚Üí D√≠lna 8</li>
        <li>Lvl 100+ ‚Üí D√≠lna 7</li>
    </ul>
  </div>
  
  <button class="add-player" onclick="addPlayerRow('playersBody')">‚ûï Add Player</button>
  
  <table>
    <thead>
      <tr>
        <th>Nickname</th>
        <th>Level</th>
        <th>Workshop Level</th>
        <th>Workshop Status</th>
        <th>Vynechan√© boje</th>
      </tr>
    </thead>
    <tbody id="playersBody">
    </tbody>
  </table>
</div>

<div id="xp" class="section">
  <h2>XP Tournament <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  
  <button class="update-btn" onclick="updateTournament('xp')">üîÑ Aktualizovat</button>
  <button class="add-player" onclick="addPlayerRow('xpBody')">‚ûï Add Player</button>
  <button class="update-btn" onclick="saveTableAsPDF('xp')">üìÑ Ulo≈æit do PDF</button>
  
  <div class="tables-container">
    <div class="table-wrapper">
      <div class="update-info">Last updated: <span id="xpUpdateDate"></span></div>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>XP Gained</th>
          </tr>
        </thead>
        <tbody id="xpBody">
          <tr><td>1</td><td contenteditable="true">Alfa</td><td contenteditable="true">1230</td></tr>
          <tr><td>2</td><td contenteditable="true">Sazaro</td><td contenteditable="true">980</td></tr>
          <tr><td>3</td><td contenteditable="true">Bandita</td><td contenteditable="true">840</td></tr>
        </tbody>
      </table>
    </div>
    <div class="chart-wrapper">
      <canvas id="xpChart"></canvas>
    </div>
  </div>
  <div class="history" id="xpHistory">
    <h3>History</h3>
    <div id="xpHistoryEntries"></div>
  </div>
</div>

<div id="herocon" class="section">
  <h2>HeroCon Tournament <span class="edit-icon" onclick="requestEditAccess()">‚úèÔ∏è</span></h2>
  
  <button class="update-btn" onclick="updateTournament('herocon')">üîÑ Aktualizovat</button>
  <button class="add-player" onclick="addPlayerRow('heroconBody')">‚ûï Add Player</button>
  <button class="update-btn" onclick="saveTableAsPDF('herocon')">üìÑ Ulo≈æit do PDF</button>
  
  <div class="tables-container">
    <div class="table-wrapper">
      <div class="update-info">Last updated: <span id="heroconUpdateDate"></span></div>
      <table>
        <thead>
          <tr>
            <th>Rank</th>
            <th>Name</th>
            <th>HeroCon Points</th>
          </tr>
        </thead>
        <tbody id="heroconBody">
          <tr><td>1</td><td contenteditable="true">Sazaro</td><td contenteditable="true">1500</td></tr>
          <tr><td>2</td><td contenteditable="true">Alfa</td><td contenteditable="true">1300</td></tr>
          <tr><td>3</td><td contenteditable="true">Bandita</td><td contenteditable="true">1100</td></tr>
        </tbody>
      </table>
    </div>
    <div class="chart-wrapper">
      <canvas id="heroconChart"></canvas>
    </div>
  </div>
  <div class="history" id="heroconHistory">
    <h3>History</h3>
    <div id="heroconHistoryEntries"></div>
  </div>
</div>

<script>
  // Z√°kladn√≠ p≈ôep√≠n√°n√≠ sekc√≠
  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }
  // Inicializace na prvn√≠ z√°lo≈æku
  showSection('guild');

  // P≈ôidat ≈ô√°dek hr√°ƒçe
  function addPlayerRow(tbodyId) {
    const tbody = document.getElementById(tbodyId);
    const rank = tbody.children.length + 1;
    const tr = document.createElement('tr');

    if(tbodyId === 'playersBody') {
      // Pro players info tabulku (5 sloupc≈Ø)
      tr.innerHTML = `
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
      `;
    } else {
      // Pro XP a HeroCon tabulky (3 sloupce, prvn√≠ bez editace)
      tr.innerHTML = `
        <td>${rank}</td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
      `;
    }
    tbody.appendChild(tr);
    if(tbodyId !== 'playersBody') {
      updateTournament(tbodyId.replace('Body','')); // Aby se hned p≈ôekreslil graf a aktualizoval ranky
    }
  }

  // Update turnaje (XP / HeroCon)
  function updateTournament(type) {
    const tbody = document.getElementById(type+'Body');
    const rows = [...tbody.rows];

    // Se≈ôadit podle hodnot ve 3. sloupci (XP nebo HC body) sestupnƒõ
    rows.sort((a,b) => {
      let aVal = parseInt(a.cells[2].textContent) || 0;
      let bVal = parseInt(b.cells[2].textContent) || 0;
      return bVal - aVal;
    });

    // Aktualizovat po≈ôad√≠ (rank)
    rows.forEach((row,i) => {
      row.cells[0].textContent = i+1;
    });

    // Vlo≈æit zpƒõt do tabulky
    tbody.innerHTML = '';
    rows.forEach(r => tbody.appendChild(r));

    // Aktualizovat datum posledn√≠ aktualizace
    const now = new Date();
    const dateString = now.toLocaleString('cs-CZ', { dateStyle: 'short', timeStyle: 'short' });
    document.getElementById(type+'UpdateDate').textContent = dateString;

    // Aktualizovat graf
    updateChart(type);

    // Ulo≈æit do historie
    saveHistory(type);
  }

  // Vytvo≈ôit grafy
  let xpChart = null;
  let heroconChart = null;

  function updateChart(type) {
    const tbody = document.getElementById(type+'Body');
    const labels = [];
    const data = [];

    for(let row of tbody.rows) {
      labels.push(row.cells[1].textContent.trim());
      data.push(parseInt(row.cells[2].textContent.trim()) || 0);
    }

    if(type === 'xp') {
      if(xpChart) xpChart.destroy();
      const ctx = document.getElementById('xpChart').getContext('2d');
      xpChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'XP Gained',
            data: data,
            backgroundColor: 'rgba(0, 255, 200, 0.6)',
            borderColor: 'rgba(0, 255, 200, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive:true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    } else if(type === 'herocon') {
      if(heroconChart) heroconChart.destroy();
      const ctx = document.getElementById('heroconChart').getContext('2d');
      heroconChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'HeroCon Points',
            data: data,
            backgroundColor: 'rgba(0, 255, 200, 0.6)',
            borderColor: 'rgba(0, 255, 200, 1)',
            borderWidth: 1
          }]
        },
        options: {
          responsive:true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }
  }

  // Ulo≈æit historii tabulky do localStorage
  function saveHistory(type) {
    const tbody = document.getElementById(type+'Body');
    // Ulo≈æit aktu√°ln√≠ stav tabulky jako JSON
    const rowsData = [];
    for(let row of tbody.rows) {
      const rowCells = [];
      for(let i=0; i<row.cells.length; i++) {
        rowCells.push(row.cells[i].textContent.trim());
      }
      rowsData.push(rowCells);
    }
    // Naƒç√≠st existuj√≠c√≠ historii
    let history = JSON.parse(localStorage.getItem(type+'History') || '[]');
    // P≈ôidat novou polo≈æku s timestampem a daty
    const now = new Date();
    history.unshift({
      timestamp: now.toLocaleString('cs-CZ', { dateStyle: 'short', timeStyle: 'short' }),
      data: rowsData
    });
    // Omezit historii na max 10 polo≈æek
    if(history.length > 10) history.pop();
    localStorage.setItem(type+'History', JSON.stringify(history));
    renderHistory(type);
  }

  // Naƒç√≠st a vykreslit historii
  function renderHistory(type) {
    const container = document.getElementById(type+'HistoryEntries');
    container.innerHTML = '';
    let history = JSON.parse(localStorage.getItem(type+'History') || '[]');
    if(history.length === 0) {
      container.innerHTML = '<p>(≈Ω√°dn√° historie)</p>';
      return;
    }
    history.forEach((entry, index) => {
      const div = document.createElement('div');
      div.className = 'history-entry';
      div.innerHTML = `
        <strong>${entry.timestamp}</strong> 
        <button onclick="loadHistory('${type}', ${index})">Naƒç√≠st</button> 
        <button onclick="deleteHistory('${type}', ${index})" style="color:#ff4d4d;">Smazat</button>
      `;
      container.appendChild(div);
    });
  }

  // Naƒç√≠st ulo≈æenou historii do tabulky
  function loadHistory(type, index) {
    let history = JSON.parse(localStorage.getItem(type+'History') || '[]');
    if(history[index]) {
      const tbody = document.getElementById(type+'Body');
      tbody.innerHTML = '';
      for(let rowData of history[index].data) {
        const tr = document.createElement('tr');
        for(let i=0; i<rowData.length; i++) {
          // Prvn√≠ sloupec Rank nen√≠ editable, ostatn√≠ ano
          if(i === 0 && (type === 'xp' || type === 'herocon')) {
            tr.innerHTML += `<td>${rowData[i]}</td>`;
          } else {
            tr.innerHTML += `<td contenteditable="true">${rowData[i]}</td>`;
          }
        }
        tbody.appendChild(tr);
      }
      updateTournament(type);
    }
  }

  // Smazat polo≈æku z historie
  function deleteHistory(type, index) {
    let history = JSON.parse(localStorage.getItem(type+'History') || '[]');
    history.splice(index, 1);
    localStorage.setItem(type+'History', JSON.stringify(history));
    renderHistory(type);
  }

  // Ulo≈æit tabulku do PDF
  async function saveTableAsPDF(type) {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // Titulek
    doc.setFontSize(16);
    doc.text(type === 'xp' ? 'XP Tournament' : 'HeroCon Tournament', 10, 15);

    // P≈ôipravit data z tabulky
    const tbody = document.getElementById(type+'Body');
    const headers = [];
    document.querySelectorAll(`#${type} table thead th`).forEach(th => headers.push(th.textContent.trim()));

    const rows = [];
    for(let row of tbody.rows) {
      const rowData = [];
      for(let cell of row.cells) {
        rowData.push(cell.textContent.trim());
      }
      rows.push(rowData);
    }

    // P≈ôidat tabulku
    doc.autoTable({
      head: [headers],
      body: rows,
      startY: 25,
      styles: { fillColor: [0, 255, 200], textColor: 30 },
      headStyles: { fillColor: [0, 180, 150], textColor: 255 },
      theme: 'grid'
    });

    // P≈ôidat datum exportu dole
    const now = new Date();
    doc.setFontSize(10);
    doc.text('Exportov√°no: ' + now.toLocaleString('cs-CZ'), 10, doc.internal.pageSize.height - 10);

    doc.save(type + '_tournament.pdf');
  }

  // Poƒç√°teƒçn√≠ naplnƒõn√≠ players info tabulky
  function initializePlayers() {
    const playersData = [
      ['Alfa', '520', '20', 'Online', '0'],
      ['Sazaro', '480', '19', 'Offline', '1'],
      ['Bandita', '450', '18', 'Online', '2'],
      ['Blesk', '430', '17', 'Online', '0'],
      ['Ranny', '400', '16', 'Offline', '3'],
      ['Loniz1337', '380', '15', 'Online', '0']
    ];
    const tbody = document.getElementById('playersBody');
    tbody.innerHTML = '';
    playersData.forEach(row => {
      const tr = document.createElement('tr');
      row.forEach(cell => {
        const td = document.createElement('td');
        td.contentEditable = 'true';
        td.textContent = cell;
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  }

  // Vy≈æ√°dat editaci guild info textarea
  function requestEditAccess() {
    const pw = prompt("Zadej heslo pro √∫pravu:");
    if(pw === "TopBanditi1") {
      const guild = document.getElementById('guildInfo');
      guild.removeAttribute('readonly');
      alert("Editace povolena! Po dokonƒçen√≠ nezapome≈à ulo≈æit zmƒõny.");
    } else {
      alert("≈†patn√© heslo.");
    }
  }

  // Inicializace
  window.onload = () => {
    initializePlayers();
    updateTournament('xp');
    updateTournament('herocon');
    renderHistory('xp');
    renderHistory('herocon');
  }
</script>

<!-- P≈ôid√°n√≠ autoTable pluginu do jspdf pro lep≈°√≠ tabulky -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

</body>
</html>
